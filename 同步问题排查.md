# 数据同步问题排查指南

## 🔍 如何检查同步是否正常工作

### 步骤 1：确认桌面端应用正在运行
1. 打开桌面端应用
2. 确保能看到你的数据（说明应用正常运行）

### 步骤 2：获取连接链接
1. 在桌面端应用中，点击 **"手机连接"** 按钮
2. 会显示一个二维码和链接
3. **重要**：链接格式应该是：`https://info-flow.netlify.app/web-dashboard.html?peer=xxxxx`
4. 或者：`http://你的电脑IP:3000/web-dashboard.html?peer=xxxxx`

### 步骤 3：在网页端打开连接链接
1. **必须使用带 `?peer=xxx` 参数的链接**
2. 如果直接访问 `https://kexin94yyds.github.io/info-filter-desktop/`，这是独立模式，不会连接桌面端

### 步骤 4：检查连接状态
打开浏览器开发者工具（F12 或 Cmd+Option+I），查看控制台：

**成功连接的标志：**
```
Connected to Desktop App
Requesting items from desktop...
Received data from desktop: {type: "items-updated", items: [...]}
Syncing desktop data to local: X items
```

**连接失败的标志：**
```
Peer error: ...
Connection error: ...
```

### 步骤 5：检查数据同步
1. 连接成功后，应该能看到状态提示："已连接到桌面端（数据已同步）"
2. 网页端应该显示桌面端的数据
3. 如果还是空的，检查控制台是否有错误

## 🛠️ 常见问题

### 问题 1：网页端显示"暂无内容"
**可能原因：**
- 没有使用带 `?peer=xxx` 参数的链接
- 连接失败
- 数据没有正确同步

**解决方法：**
1. 确认使用的是带 `peer` 参数的链接
2. 打开浏览器控制台查看错误信息
3. 尝试刷新页面

### 问题 2：连接失败
**可能原因：**
- 桌面端应用没有运行
- 网络问题
- PeerJS 服务器连接问题

**解决方法：**
1. 确认桌面端应用正在运行
2. 检查网络连接
3. 尝试重新生成连接链接

### 问题 3：数据没有同步
**可能原因：**
- 连接成功但数据请求失败
- 数据合并逻辑问题

**解决方法：**
1. 打开浏览器控制台，查看是否有数据接收日志
2. 检查是否有错误信息
3. 尝试手动刷新页面

## 📝 调试步骤

1. **打开浏览器开发者工具**（F12）
2. **切换到 Console 标签**
3. **访问带 peer 参数的链接**
4. **查看控制台输出**，应该能看到：
   - `Running in Hybrid Mode - Connecting to desktop: xxxx`
   - `Connected to Desktop App`
   - `Requesting items from desktop...`
   - `Received data from desktop: ...`
   - `Syncing desktop data to local: X items`

5. **如果看到错误**，请记录错误信息

## 💡 快速测试方法

1. **桌面端**：添加一条测试数据
2. **桌面端**：点击"手机连接"，获取链接
3. **网页端**：访问链接（必须带 `?peer=xxx`）
4. **网页端**：应该能看到刚才添加的测试数据

如果还是看不到，请检查浏览器控制台的错误信息。

